<!DOCTYPE html>
<html lang="en"></html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" type="text/css" href="css/sessionsStyle.css">
  <title>Saved Sessions</title>
</head>
<body>
  <div id="app" v-cloak>
    <div class="sidenav">
      <button @click="deleteEmptyGroups">Delete empty groups</button>
      <h3>GROUPS</h3>
      <div class="group-side" v-for="group in state.groups" @click="scrollto(group.id)">
        <div :data-id="group.id" :class="inDrag ? 'sidenav-group drop-container' : 'sidenav-group'" @dragover.prevent="" @drop="moveTab" @dragenter="highlight" @dragleave="removeHighlight">{{group.title}}</div>
      </div>
      <h3>TAGS</h3>
      <div class="clickable" v-if="state.tags.length != 0" @click="clearSelectedTags">ALL</div>
      <div class="clickable" v-for="tag in state.tags">
        <input class="editor" v-model="tag.title" :placeholder="tag.title" v-if="updateTagID == tag.id" @keyup.enter="updateTagID = ''" @blur="updateTagID = ''" v-focus v-resizable type="text"><span @click="addToSelectedTags(tag.id)" v-else="">{{tag.title}}</span><img class="favicon" @click="updateTagID = tag.id" src="./images/rename.png"><img class="favicon" @click="deleteTag(tag.id)" src="./images/delete.png">
      </div>
    </div>
    <div class="fixed-nav-bar" v-if="merge.length != 0">
      <button @click="mergeGroups">Merge</button>
      <input v-model="mergeTitle" @keyup.enter="mergeGroups" placeholder="New group title" type="text"><span>{{merge.length}} groups selected</span>
    </div>
    <div class="main">
      <h3 v-if="selectedTags.length != 0">Filtered by tag: {{selectedTag}}</h3>
      <h1>Saved Sessions - There are {{tabsNumber}} saved tabs.</h1>
      <h3 v-if="state.groups.length == 0">There are no saved sessions!</h3>
      <button @click="createNewGroup">Add Group</button>
      <draggable v-model="state.groups" handle=".title-handle">
        <div :class="merge.includes(group.id) ? 'group selected-group' : 'group'" v-for="group in filteredGroups" :data-id="group.id"><img class="title-handle" src="images/handle.png">
          <input class="editor" v-model="group.title" :placeholder="group.title" v-if="updateGroupID == group.id" @keyup.enter="updateGroupID = ''" @blur="updateGroupID = ''" v-focus v-resizable type="text">
          <h2 class="title unselectable" @dblclick="updateGroupID = group.id" v-else="">{{group.title}}</h2>
          <h3 class="title unselectable">{{ group.tabs.length }} tabs</h3><span class="header-action clickable unselectable" @click="deleteGroup(group.id)">Delete Group</span><span class="header-action clickable unselectable" @click="openAlltabs(group.id)">Open all tabs</span><span class="date">Created on {{group.date}}</span>
          <button @click="addToMerge(group.id)">Select</button>
          <div class="dropdown">
            <div class="show-more" @click="showTagMenu"></div>
            <div class="dropdown-content"><a class="unselectable" @click="toggleTagInGroup(group.id, tag.id)" v-for="tag in state.tags"><img class="tick" v-if="group.tags.includes(tag.id)" src="./images/tick.png" alt=""><span>{{tag.title}}</span></a>
              <input placeholder="NEW TAG..." @keyup.enter="addTag" type="text">
            </div>
          </div>
          <draggable v-model="group.tabs" group="session" handle=".handle" @start="saveID" @end="endDrag">
            <div class="tab unselectable" v-for="tab in group.tabs" :data-id="tab.id"><img class="clickable hidden" @click="deleteTab(group.id, tab.id)" src="./images/delete.png"><img @click="starTab(group.id, tab.id)" :class="tab.starred ? 'clickable visible' : 'clickable hidden'" :src="tab.starred ? './images/starred.png' : './images/star-empty.png'"><img class="handle" src="images/handle.png"><img class="favicon" :src="getFavicon(tab)"><a :href="tab.url" target="_blank">{{tab.title}}</a></div>
          </draggable>
        </div>
      </draggable>
    </div>
  </div>
  <script src="lib/vue.js"></script>
  <!-- development version, includes helpful console warnings-->
  <script src="lib/Sortable.min.js"></script>
  <script src="lib/vuedraggable.umd.min.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/sessions.js"></script>
</body>